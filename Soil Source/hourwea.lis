Silverfrost FTN95/x64 Ver 8.50.0  hourwea.for  Sun Oct 27 15:06:02 2019

Compiler used    [C:\Program Files (x86)\Silverfrost\FTN95\FTN95.EXE]
Salflibc path    [C:\Program Files (x86)\Silverfrost\FTN95\salflibc.dll]
Salflibc version [21.4.29.16]
Compiler options in effect:
    64;BINARY;CFPP;ERROR_NUMBERS;FIXED_FORMAT;FPP;IGNORE;LIST;
    LIST_INSERT_FILES;NO_BANNER;TABS;UNLIMITED_ERRORS;VS7;XREF;

   0001   cdt this version had code added to calculate rain infiltration as                      AT 0
   0002   c constant head infiltration for a period. I have to finish it to allow final          AT 11a
   0003   c flux to just finish up the water.                                                    AT 11a
   0004   CDT  9/10/2014 Added CO2 as a weather variable and took it out of the                  AT 11a
   0005   CDT   initials file.                                                                   AT 11a
   0006                                                                                          AT 11a
   0007   C**  MSW1-  switch to indicate if daily wet bulb temperatures are     **               AT 11a
   0008   C**         available (=1 if YES).                                    **               AT 11a
   0009   C**                                                                   **               AT 11a
   0010   C**  MSW2-  switch to indicate if hourly wind is available (=1 if YES).**              AT 11a
   0011   C**  MSW3-  Not used in hourly data (Daily rain intensities)          **               AT 11a
   0012   C** cdt don't think these two variables (above) are needed  for hourly data            AT 11a
   0013   C**  MSW4-  Chemical concentrations in rain water                     **               AT 11a
   0014   C**  MSW5-  1 for flood irrigation                                    **               AT 11a
   0015   C**  MSW6-  1 if relative humidity is available                       **               AT 11a
   0016   C**  MSW7-  1 if Daily CO2 Measurements are available                 **               AT 11a
   0017   C**                                                                   **               AT 11a
   0018   C**  BSOLAR-factor for changing solar radiation units. Equals         **               AT 11a
   0019   C**         radiation in J m-2 divided by radiation in units used in  **               AT 11a
   0020   C**         weather data file.                                        **               AT 11a
   0021   C**                                                                   **               AT 11a
   0022   C**  BTEMP- factor for changing temperature units. Equals change in   **               AT 11a
   0023   C**         temperature, in units used in weather data file, that is  **               AT 11a
   0024   C**         equivalent to a one oC change.                            **               AT 11a
   0025   C**                                                                   **               AT 11a
   0026   C**  ATEMP- factor for changing temperature units. Equals temperature **               AT 11a
   0027   C**         used in weather data file that is equivalent to zero oC.  **               AT 11a
   0028   C**                                                                   **               AT 11a
   0029   C**  ERAIN- factor for changing rain units. Equals rainfall in mm     **               AT 11a
   0030   C**         day-1 divided by rainfall in units used in weather data   **               AT 11a
   0031   C**         file.                                                     **               AT 11a
   0032   C**                                                                   **               AT 11a
   0033   C**  BWIND- factor for changing wind units. Equals windspeed in       **               AT 11a
   0034   C**         km hr-1 divided by windspeed in units used in weather     **               AT 11a
   0035   C**         data file.                                                **               AT 11a
   0036   C**                                                                   **               AT 11a
   0037   C**                                                                   **               AT 11a
   0038   C**                                                                   **               AT 11a
   0039   C**  WIND-  if windspeed is unavailable read in average value for     **               AT 11a
   0040   C**         site. windspeed at 2 meters (km hr-1).                    **               AT 11a
   0041   C**                                                                   **               AT 11a
   0042   C** CO2   -  If daily values are not available read average           **               AT 11a
   0043   C**                                                                   **               AT 11a
   0044   C**                                                                   **               AT 11a
   0045   C**  (File 1, Line 3 to EOF, free format)                             **               AT 11a
   0046   C**      (RH, WIND, TWET and TDRY CO2 are optional)                  **                AT 11a
   0047   C**                                                                   **               AT 11a
   0048   C**  JDAY-  day of year- Julian Date.  Only used for management       **               AT 11a
   0049   C**         of the weather file. Program converts calendar date       **               AT 11a
   0050   C**         to a day of year relative to 3/1/1900                     **               AT 11a
   0051   C**  DATE-  calendar date in quotes "01/01/2001"                      **               AT 11a
   0052   C**                                                                   **               AT 11a
   0053   C**  HOUR-  Hour of Day                                               **                                                                ** AT 11a
   0054   C**                                                                   **               AT 11a
   0055   C**  RI-    daily solar radiation integral (J m-2).                   **               AT 11a
   0056   C**                                                                   **               AT 11a
   0057   C**  TMAX-  maximum air temperature during the day (oC).              **               AT 11a
   0058   C**                                                                   **               AT 11a
   0059   C**  TMIN-  minimum air temperature during the day (oC).              **               AT 11a
   0060   C**                                                                   **               AT 11a
   0061   C**  RAIN-  rainfall (or irrigation) (mm day-1).                      **               AT 11a
   0062   C**                                                                   **               AT 11a
   0063   C**  WIND-  windspeed at 2 meters (km hr-1).                          **               AT 11a
   0064   C**                                                                   **               AT 11a
   0065   C**  RH-    Relative Humidity, (%, i.e., 90.2)                        **               AT 11a
   0066   C**                                                                   **               AT 11a
   0067   C**  TWET-  wet bulb temperature (oC).                                **               AT 11a
   0068   C**                                                                   **               AT 11a
   0069   C**  TDRY- dry bulb temperature corresponding to TWET (oC).           **               AT 11a
   0070   C**                                                                   **               AT 11a
   0071   C**  Hourly values for radiation will be converted to watts m-2 as                     AT 11a
   0072   C**   soon as they are read in.                                                        AT 11a
   0073   C**                                                                   **               AT 11a
   0074                                                                                          AT 11a
   0075   c inputs hourly data                                                                   AT 11a
   0076         Subroutine SetSurfaceH()                                                         AT 11a
   0077         Include 'Public.ins'                                                             AT 11a
 1/0001   c  dt ToDo - simplyfy common blocks so only variables needed in plant model            AT 11a
 1/0002   c dt ToDo May 2016 added VarBW_old for debugging purposes can be removed later         AT 11a
 1/0003   c   will be transferred.                                                               AT 11a
 1/0004         Parameter (NumNPD=4000, NumElD=3500, NumBPD=600, NSeepD = 2,                     AT 11a
 1/0005        &           NumSPD= 30, NumSD =10, NDrainD=2,NumDR=30,                            AT 11a
 1/0006        &           NumGD = 3, NumPlD=100,                                                AT 11a
 1/0007        &           NMatD=15,MNorth=4,                                                    AT 11a
 1/0008        &           NumModD=20, MBandD=15,  NumSurfDatD=3+NumGD+NumSD)                    AT 11a
 1/0009                                                                                          AT 11a
 1/0010                                                                                          AT 11a
 1/0011         Double precision Time,Step,tNext,                                                AT 11a
 1/0012        &             dtOpt,dtMin,dMul1,dMul2,dtMx,tTDB,tFin,tatm                         AT 11a
 1/0013         Double precision  A1,B1,VRV,RES,RQI,RQ,QI,QQ,RQIDOT                              AT 11a
 1/0014         Double precision  ECNVRG, RCNVRG,ACNVRG                                          AT 11a
 1/0015         Double precision Starter, TimeStep                                               AT 11a
 1/0016                                                                                          AT 11a
 1/0017         Real BlkDn, FracSind, FracClay, FracOM, hCritS,hCritA                            AT 11a
 1/0018         Real nodeArea                                                                    AT 11a
 1/0019         Integer CodeW,CodeS,CodeT,CodeG,errPlant                                         AT 11a
 1/0020         Integer MaxItO, OutPutSoilNo, OutPutSoilYes                                      AT 11a
 1/0021         Logical*1 lOrt                                                                   AT 11a
 1/0022         Integer DailyOutput, HourlyOutput,RunFlag,                                       AT 11a
 1/0023        &  DailyWeather,HourlyWeather,ITIME, IDAWN, IDUSK,                                AT 11a
 1/0024        &  beginDay, sowingDay, endDay,year                                               AT 11a
 1/0025                                                                                          AT 11a
 1/0026         character WeatherFile*132, TimeFile*132, BiologyFile*132,                        AT 11a
 1/0027        &          ClimateFile*132, NitrogenFile*132, SoluteFile*132,                     AT 11a
 1/0028        &          SoilFile*132,                                                          AT 11a
 1/0029        &          ManagementFile*132,DripFile*132,                                       AT 11a
 1/0030        &          WaterFile*132, WaterBoundaryFile*132,                                  AT 11a
 1/0031        &          PlantGraphics*132,InitialsFile*132,  VarietyFile*132,                  AT 11a
 1/0032        &          NodeGraphics*132,ElemGraphics*132,                                     AT 11a
 1/0033        &          NodeGeomFile*132,                                                      AT 11a
 1/0034        &          GeometryFile*132,SurfaceGraphics*132,                                  AT 11a
 1/0035        &          FluxGraphics*132,MassBalanceFile*132,                                  AT 11a
 1/0036        &          MassBalanceFileOut*132,LeafGraphics*132,                               AT 11a
 1/0037        &          RunFile*132                                                            AT 11a
 1/0038         Common /grid_public/  NumNP, NumEl, IJ, KAT, MBand,Nmat,                         AT 11a
 1/0039        &        KX(NumElD,4),x(NumNPD), y(NumNPD), Area(NumElD),                         AT 11a
 1/0040        &        nodeArea(NumNPD)                                                         AT 11a
 1/0041         Common /nodal_public/ NumSol,NumG,ListN(NumNPD),ListNE(NumNPD),                  AT 11a
 1/0042        &       MatNumN(NumNPD),hNew(NumNPD),ThNew(NumNPD), Vx(NumNPD),                   AT 11a
 1/0043        &       Vz(NumNPD),Q(NumNPD), Conc(NumNPD,NumSD),                                 AT 11a
 1/0044        &       g(NumNPD,NumGD), Tmpr(NumNPD), Con(NumNPD),TcsXX(NumNPD),                 AT 11a
 1/0045        &       RO(NumNPD), hNew_org(NumNPD),QAct(NumNPD),ThetaAvail,                     AT 11a
 1/0046        &       ThetaFull, ThAvail(NumNPD),ThFull(NMAtD),  lOrt                           AT 11a
 1/0047         Common /elem_public/  MatNumE(NumElD),Sink(NumNPD),                              AT 11a
 1/0048        &       cSink(NumNPD,NumSD),gSink(NumNPD,NumGD),tSink(NumNPD),                    AT 11a
 1/0049        &       RTWT(NumNPD),RUTDEN(NumNPD),RMassM(NumNPD),RDenM(NumNPD),                 AT 11a
 1/0050        &       RMassY(NumNPD), RDenY(NumNPD)                                             AT 11a
 1/0051         Common /bound_public/ NumBP, NSurf, NVarBW,NVarBS,NVarBT,NVarBG,                 AT 11a
 1/0052        &       NumSurfDat, NSeep, NSP(NSeepD), NP(NSeepD,NumSPD),                        AT 11a
 1/0053        &       NDrain,NDR(NDrainD),ND(NDrainD,NumDR),                                    AT 11a
 1/0054        &       KXB(NumBPD),                                                              AT 11a
 1/0055        &       CodeW(NumNPD),CodeS(NumNPD),CodeT(NumNPD),CodeG(NumNPD),                  AT 11a
 1/0056        &       PCodeW(NumNPD),Width(NumBPD),                                             AT 11a
 1/0057        &       VarBW(NumBPD,3),VarBW_Old(NumBPD,3),                                      AT 11a
 1/0058        &       VarBS(NumBPD,NumSD),VarBT(NumBPD,4),                                      AT 11a
 1/0059        &       VarBG(NumBPD,NumGD,3),EO,Tpot                                             AT 11a
 1/0060         Common /time_public/tNext(NumModD),dtMx(4),Time,Step,dtOpt,                      AT 11a
 1/0061        &        dtMin, dMul1, dMul2,  tTDB(4), Tfin,tAtm, Tinit,                         AT 11a
 1/0062        &        lInput,Iter,DailyOutput,HourlyOutput,RunFlag,                            AT 11a
 1/0063        &          DailyWeather,HourlyWeather,                                            AT 11a
 1/0064        &          beginDay, sowingDay, endDay,                                           AT 11a
 1/0065        &          OutputSoilNo, OutPutSoilYes, Year,                                     AT 11a
 1/0066        &           iTime, iDawn, iDusk, dumpad, TimeStep                                 AT 11a
 1/0067         Common /module_public/  NumMod,Movers(4), NShoot                                 AT 11a
 1/0068         Common /error_public/errPlant                                                    AT 11a
 1/0069         Common /Solver_public/IAD(MBandD,NumNPD), IADN(NumNPD),                          AT 11a
 1/0070        &        IADD(NumNPD),A1(MBandD,NumNPD),B1(NumNPD),                               AT 11a
 1/0071        &        VRV(NumNPD),RES(NumNPD),RQI(NumNPD,MNorth),                              AT 11a
 1/0072        &        QQ(NumNPD), RQ(NumNPD),QI(NumNPD,MNorth), RQIDOT(MNorth)                 AT 11a
 1/0073                                                                                          AT 11a
 1/0074         Common /Initvar/ ECNVRG, RCNVRG, ACNVRG, MaxItO,EPSI_Heat,                       AT 11a
 1/0075        &                 EPSI_Solute, hCritS, hCritA                                     AT 11a
 1/0076                                                                                          AT 11a
 1/0077         Common /DataFilenames/ Starter, WeatherFile, TimeFile,                           AT 11a
 1/0078        &          BiologyFile,ClimateFile, NitrogenFile, SoluteFile,                     AT 11a
 1/0079        &          SoilFile,                                                              AT 11a
 1/0080        &          ManagementFile,DripFile,                                               AT 11a
 1/0081        &          WaterFile, WaterBoundaryFile,                                          AT 11a
 1/0082        &          PlantGraphics,InitialsFile,VarietyFile,                                AT 11a
 1/0083        &          NodeGraphics,ElemGraphics,NodeGeomFile,                                AT 11a
 1/0084        &          GeometryFile,SurfaceGraphics,                                          AT 11a
 1/0085        &          FluxGraphics, MassBalanceFile,MassBalanceFileOut,                      AT 11a
 1/0086        &          LeafGraphics,RunFile                                                   AT 11a
 1/0087                                                                                          AT 11a
 1/0088   c the following blocks are not passed to the crop model                                AT 11a
 1/0089         Common /Nodal_pub_Aux/ ROForInfil(NumBPD)                                        AT 11a
 1/0090                                                                                          AT 11a
 1/0091         Common /Materials/BlkDn(NMatD),FracSind(NMatD), FracClay(NMatD),                 AT 11a
 1/0092        &           FracOM(NMatD),TUpperLimit(NMatD), TLowerLimit(NMatD)                  AT 11a
   0078         Include 'Puplant.ins'                                                            AT 11a
 1/0001                                                                                          AT 11a
 1/0002         REAL*8 PCRL, PCRQ,PCRS,ET_demand,LCAI,COVER,CONVR                                AT 11a
 1/0003         Real*8 HourlyCarboUsed                                                           AT 11a
 1/0004         REAL*4 SHADE,HEIGHT,LAI,AWUPS,NitroDemand,NDemandError                           AT 11a
 1/0005         REAL LAREAT, MaxRootDepth, InitialRootCarbo                                      AT 11a
 1/0006         integer isGerminated, isEmerged                                                  AT 11a
 1/0007                                                                                          AT 11a
 1/0008   C includes variables shared with crop model                                            AT 11a
 1/0009         Common /ShootR/   PCRL,PCRQ,PCRS,HourlyCarboUsed, ET_demand,                     AT 11a
 1/0010        &                  LCAI,COVER,CONVR,                                              AT 11a
 1/0011        &                  MaxRootDepth,SHADE,HEIGHT,LAI,AWUPS,                           AT 11a
 1/0012        &                  NitroDemand,xBSTEM,yBSTEM,SGT,PSIM,                            AT 11a
 1/0013        &                  LAREAT,POPROW,ROWSP,ROWANG,PopArea,                            AT 11a
 1/0014        &                  CEC,EORSCS,AWUPSS,SOLRAD,                                      AT 11a
 1/0015        &                  Total_Eor,Total_Pcrs,sincrsink,PSILD,                          AT 11a
 1/0016        &                  OSMFAC,EOMULT,PSIL_,NDemandError,                              AT 11a
 1/0017        &                  CumulativeNDemandError,TotalRootWeight,                        AT 11a
 1/0018        &                  InitialRootCarbo,                                              AT 11a
 1/0019        &                  ConstI(2),constK(2), Cmin0(2),                                 AT 11a
 1/0020        &                  isGerminated, isEmerged                                        AT 11a
 1/0021                                                                                          AT 11a
 1/0022                                                                                          AT 11a
 1/0023   C includes variables only used inside 2dsoil                                           AT 11a
 1/0024         Common /shtR_public/ RVR(NumNPD), AWUP(NumELD),PSISM,PSILT,EOR,                  AT 11a
 1/0025        &                     YRL(NumNPD), RGCF(NumNPD),iFavRoot(NumNPD),                 AT 11a
 1/0026        &                     PSIS(NumNPD), TS(NumNPD),COND(NumNPD),                      AT 11a
 1/0027        &                     PDWR(NumNPD),                                               AT 11a
 1/0028        &                     DRL(NumNPD),WUPM(NumNPD),                                   AT 11a
 1/0029        &                     WUPN(NumNPD),WUPT(NumNPD),TPL,PPDRL(NumNPD),                AT 11a
 1/0030        &                     ADWR(NumNPD), AWR(NumNPD), ADRL(NumNPD),RTWL,               AT 11a
 1/0031        &                     RtMinWtPerUnitArea,Wl,Wa,Wr,Wb,ALPY,                        AT 11a
 1/0032        &                     WidthE(NumEld),HeightE(NumEld),                             AT 11a
 1/0033        &                  PILD,VMAX,vegsrc, potential_T,                                 AT 11a
 1/0034        &                   potential_T_EO,                                               AT 11a
 1/0035        &                  AWUPS_old, WUPMS, EORSCF,WUPDS, WUP2S,                         AT 11a
 1/0036        &                 WUP0S, DPSI02,SCF, PSIST,PROPAR,                                AT 11a
 1/0037        &                 VUP(NumNPD,2),FUP(NumNPD,2)                                     AT 11a
 1/0038   c      end                                                                             AT 11a
   0079         Include 'Puweath.ins'                                                            AT 11a
 1/0001         REAL IRAV,IR,LAMDAS,LAMDAC,LATUDE,Longitude                                      AT 11a
 1/0002         REAL WATACT,WATRAT,WATPOT                                                        AT 11a
 1/0003         Integer AutoIrrigateF                                                            AT 11a
 1/0004                                                                                          AT 11a
 1/0005         Common /Weath/ MSW1,MSW2,MSW3,MSW4,MSW5,MSW6,                                    AT 11a
 1/0006        &               MSW7,BSOLAR,ETCORR,                                               AT 11a
 1/0007        &               BTEMP,ATEMP,ERAIN,BWIND,BIR,WINDA,IRAV,JDAY,                      AT 11a
 1/0008        &               NCD,JDLAST, CLDFAC,DEL(24),RINT(24),GAMMA,RNS,                    AT 11a
 1/0009        &               RNC,RAIN,IR,WIND,CO2,TDUSK,TDUSKY,                                AT 11a
 1/0010        &               TWET,TDRY,CPREC(NumSD),TAIR(24),VPD(24),ROUGH,                    AT 11a
 1/0011        &               RADINT(24),WATTSM(24),DIFINT(24),                                 AT 11a
 1/0012        &               ROWINC(24),CLOUD,SHADOW(24),DIFWAT(24),                           AT 11a
 1/0013        &               DIRINT(24),WATACT,WATRAT,WATPOT,RNLU,                             AT 11a
 1/0014        &               NumF(40),NumFP,hFur(40),QF,IFUR,GAIR(NumGD),PG,                   AT 11a
 1/0015        &               LATUDE,Longitude, Altitude, RI,PAR(24),                           AT 11a
 1/0016        &               PARINT(24),daylng,AutoIrrigAmt,                                   AT 11a
 1/0017        &               AutoIrrigateF                                                     AT 11a
   0080         Parameter (PERIOD =1./24.)                                                       AT 11a
   0081         integer jday,m,DayOfYear,CurYear,Modnum, ThisYear                                AT 11a
   0082         double precision St,t                                                            AT 11a
   0083         real Interval                                                                    AT 11a
   0084         character*10 date                                                                AT 11a
   0085         integer HOUR                                                                     AT 11a
   0086         Common /weather/ il,im,HRAIN(24),HSR(24),HTEMP(24),HTEMPY(24),                   AT 11a
   0087        &     HWIND(24), Rel_Humid(24),AVP(24),isol,Date1,ModNum,                         AT 11a
   0088        &     Interval                                                                    AT 11a
   0089                                                                                          AT 11a
   0090         Dimension CLIMAT(20),SDERP(9),SINALT(24),SINAZI(24),HRANG(24),                   AT 11a
   0091        &           SARANG(24),                                                           AT 11a
   0092        &           SOLALT(24),SOLAZI(24),                                                AT 11a
   0093        &           HTM(24)                                                               AT 11a
D:\2DSOIL_Grape\Soil Source\hourwea.for(93) : warning 197 - Variable HTM has been declared but not used 
   0094         Dimension xS(NumBPD),iS(NumBPD),kS(NumBPD)                                       AT 11a
   0095         Data SDERP/0.3964E-0,0.3631E1,0.3838E-1,0.7659E-1,0.0000E0,                      AT 11a
   0096        & -0.2297E2,-0.3885E0,-0.1587E-0,-0.1021E-1/,PI /3.1415926/,                      AT 11a
   0097        &  TPI /6.2831852/,DEGRAD/0.017453293/,IPERD/24/                                  AT 11a
   0098                                                                                          AT 11a
   0099   CYAP                                                                                   AT 11a
D:\2DSOIL_Grape\Soil Source\hourwea.for(97) : warning 1226 - A REAL constant has been truncated with possible loss of precision - maybe a KIND is required 
D:\2DSOIL_Grape\Soil Source\hourwea.for(97) : warning 1226 - A REAL constant has been truncated with possible loss of precision - maybe a KIND is required 
   0100          If(NSurf.eq.0) then                                                             AT 11a
   0101              RowSP=1.                                                                    AT 11f
   0102             height=0.                                                                    AT 11f
   0103           endif                                                                          AT 11f
   0104   CYAPEND                                                                                AT 11f
   0105         t=Time                                                                           AT 11f
   0106         St=0.1D0*Step                                                                    AT 11f
   0107         If (lInput.eq.0) goto 11                                                         AT 11f
   0108   C                                                                                      AT 11f
   0109   C  First and last days                                                                 AT 11f
   0110   C                                                                                      AT 11f
   0111         JDFRST=idint(t+St)                                                               AT 11f
   0112         JDLAST=idint(tFin+St)                                                            AT 1e6
   0113   c                                                                                      AT 1e6
   0114           NumMod=NumMod+1                                                                AT 1e6
   0115           ModNum=NumMod                                                                  AT 1e6
   0116           tNext(ModNum)=time                                                             AT 1e6
   0117           Interval=1/24.                                                                 AT 1e6
   0118                                                                                          AT 1e6
   0119   c                                                                                      AT 1e6
   0120         im=160                                                                           AT 1e6
   0121         il=0                                                                             AT 1e6
   0122   C      Open (5,file='Weatherhrly.dat',status='old',ERR=10)                             AT 1e6
   0123         Open (5,file=ClimateFile,status='old',ERR=10)                                    AT 1e6
   0124   cdt                                                                                    AT 294
   0125   c       Do i=1,NumNP                                                                   AT 294
   0126   c        PcodeW(i)=CodeW(i)                                                            AT 294
   0127   c         Enddo                                                                        AT 294
   0128   C                                                                                      AT 294
   0129   C  Read descriptors and conversion constants for weather data                          AT 294
   0130   C                                                                                      AT 294
   0131         im=im+1                                                                          AT 294
   0132         il=il+1                                                                          AT 294
   0133         Read (5,*,ERR=10)                                                                AT 294
   0134         im=im+1                                                                          AT 2f7
   0135         il=il+1                                                                          AT 2f7
   0136         Read (5,*,ERR=10)                                                                AT 2f7
   0137         im=im+1                                                                          AT 35a
   0138         il=il+1                                                                          AT 35a
   0139         Read (5,*,ERR=10) LATUDE                                                         AT 35a
   0140         im=im+1                                                                          AT 3d8
   0141         il=il+1                                                                          AT 3d8
   0142         Read (5,*,ERR=10)                                                                AT 3d8
   0143         im=im+1                                                                          AT 43b
   0144         il=il+1                                                                          AT 43b
   0145         Read (5,*,ERR=10) MSW1,MSW2,MSW3,MSW4,MSW5,MSW6,MSW7                             AT 43b
   0146         im=im+1                                                                          AT 55b
   0147         il=il+1                                                                          AT 55b
   0148         Read (5,*,ERR=10)                                                                AT 55b
   0149         im=im+1                                                                          AT 5be
   0150         il=il+1                                                                          AT 5be
   0151         Read (5,*,ERR=10)                                                                AT 5be
   0152         im=im+1                                                                          AT 65a
   0153         il=il+1                                                                          AT 65a
   0154          ISOL=NumSol*Movers(2) ! Movers(2) is the solute mover                           AT 65a
   0155          Read (5,*,ERR=10) BSOLAR,BTEMP,ATEMP,ERAIN,BWIND,BIR                            AT 65a
   0156   cdt 10/25/2007 changed from 1-MSW4                                                     AT 7cc
   0157         ISOL=NumSol*(MSW4)*Movers(2)                                                     AT 7cc
   0158   cdt  9/10/2014 added CO2 as a weather variable. Made this line consistent              AT 7cc
   0159   Cdt   with the same line from the daily weather file                                   AT 7cc
   0160   CDT    TODO this needs to be tested fully                                              AT 7cc
   0161   CDT  1/2016 fix for dew point and co2                                                  AT 7cc
   0162   CDT  this line determines what is read from the last line in the climate file - this last line contains averages to be AT 7cc
   0163   CDT  used when daily/hourly values are not available.                                  AT 7cc
   0164   CDT at the minimum (for hourly) ncd will be three - wind, irav, CO2, because only these three have average values AT 7cc
   0165   CDT to be used in the program.                                                         AT 7cc
   0166                                                                                          AT 7cc
   0167   CDT columns should be ordered as in the msw indices in the climate file                AT 7cc
   0168   CDT  hourly bulb, hourly wind, hourl rain intensity, hourly concentration, hourly furrow, hourly AT 7cc
   0169   CDT  relative humidity, hourly CO2. For now we will only consider one solute in the    AT 7cc
   0170   CDT  rainfall, that is Nitrogen. We may have more than one column of concentrations if there is more than one solute AT 7cc
   0171   CDT  but this is not fully implemented yet                                             AT 7cc
   0172   CDT if MSW6 is 0 then there is no column for RH and it is calculated from minimum temperature - no average is used AT 7cc
   0173   CDT if MSW is one, then RH is not used even if present                                 AT 7cc
   0174   CDT daily concentration has been modified to use only nitrogen in rainfall (no gasses). AT 7cc
   0175                                                                                          AT 7cc
   0176         NCD=4-MSW2+ISOL-MSW3-MSW7                                                        AT 7cc
   0177   C      NCD=1-MSW2+ISOL+(NumG+1)*Movers(4)                                              AT 7cc
   0178         im=im+1                                                                          AT 7cc
   0179         il=il+1                                                                          AT 7cc
   0180         Read (5,*,ERR=10)                                                                AT 7cc
   0181         im=im+1                                                                          AT 82f
   0182         il=il+1                                                                          AT 82f
   0183         Read (5,*,ERR=10)                                                                AT 82f
   0184         im=im+1                                                                          AT 892
   0185         il=il+1                                                                          AT 892
   0186         Read(5,*,ERR=10) (CLIMAT(i),i=1,NCD)                                             AT 892
   0187         IF(MSW2.eq.0) WINDA=CLIMAT(1)                                                    AT 955
   0188         IF(MSW3.eq.0) then                                                               AT 989
   0189             IRAV= CLIMAT(2)                                                              AT 989
   0190             AutoIrrigAmt=IRAV*BIR   !need to handle case when and if intensities are given per hour AT a0a
   0191          EndIf                                                                           AT a0a
   0192   C     IF(MSW4.eq.0.AND.NumSol.gt.0) then                                               AT a0a
   0193   Cdt 02/03/2009 changed from 0-MSW4                                                     AT a0a
   0194         IF(MSW4.eq.1.AND.NumSol.gt.0) then                                               AT a0a
   0195           Do i=1,NumSol                                                                  AT a0a
   0196             CPREC(i)=CLIMAT(2-MSW2-MSW3+i) ! should be 1 or 2 if no irav or winda and one or two solutes AT a2f
   0197           Enddo                                                                          AT a6c
   0198         Endif                                                                            AT ac4
   0199   CDT 1/2016 no gasses for now                                                           AT ac4
   0200   !      If(NumG.ne.0) then                                                              AT ac4
   0201   !        PG=CLIMAT(3-MSW2+ISOL)                                                        AT ac4
   0202   !        Do i=1,NumG                                                                   AT ac4
   0203   !          GAIR(i)=CLIMAT(3-MSW2-MSW3+ISOL+i)                                          AT ac4
   0204   !        Enddo                                                                         AT ac4
   0205   !      Endif                                                                           AT ac4
   0206         IF(MSW7.eq.0) then                                                               AT ac4
   0207            CO2=CLIMAT(NCD)  ! last one is always co2                                     AT ac4
   0208          Endif                                                                           AT ac4
   0209                                                                                          AT ac4
   0210         close(5)                                                                         AT ac4
   0211   C                                                                                      AT b82
   0212   C Total number of weather data                                                         AT b82
   0213   C     minimum of three columns for radiation, temperature and rainfall (should always be first three) for hourly AT b82
   0214   C                                                                                      AT b82
   0215         NCD=3+2*MSW1+MSW2+ISOL*MSW4+MSW6+MSW7                                            AT b82
   0216   C                                                                                      AT b82
   0217   C     Nodal numbers of furrow nodes                                                    AT b82
   0218   C                                                                                      AT b82
   0219         im1=im                                                                           AT b82
   0220         il1=il                                                                           AT b82
   0221         im=180                                                                           AT b82
   0222         il=0                                                                             AT b82
   0223         If(MSW5.gt.0) then                                                               AT b82
   0224           Open(6,file='Furnod.dat',status='old',ERR=10)                                  AT b82
   0225           im=im+1                                                                        AT c28
   0226           il=il+1                                                                        AT c28
   0227           Read(6,*,ERR=10)                                                               AT c28
   0228           im=im+1                                                                        AT c8b
   0229           il=il+1                                                                        AT c8b
   0230           Read(6,*,ERR=10)                                                               AT c8b
   0231           im=im+1                                                                        AT cee
   0232           il=il+1                                                                        AT cee
   0233           Read(6,*,ERR=10) NumFP                                                         AT cee
   0234           im=im+1                                                                        AT d6c
   0235           il=il+1                                                                        AT d6c
   0236           Read(6,*,ERR=10)                                                               AT d6c
   0237           im=im+1                                                                        AT dcf
   0238           il=il+1                                                                        AT dcf
   0239           Read(6,*,ERR=10) (NumF(i),i=1,NumFP)                                           AT dcf
   0240           im=im+1                                                                        AT eae
   0241           il=il+1                                                                        AT eae
   0242           Read(6,*,ERR=10)                                                               AT eae
   0243           im=im+1                                                                        AT f11
   0244           il=il+1                                                                        AT f11
   0245           Read(6,*,ERR=10) (hFur(i),i=1,NumFP)                                           AT f11
   0246           IFUR=0                                                                         AT 100b
   0247         Endif                                                                            AT 100b
   0248         im=im1                                                                           AT 100b
   0249         il=il1                                                                           AT 100b
   0250   C                                                                                      AT 100b
   0251   C FIND CORRECT DAY IN WEATHER FILE                                                     AT 100b
   0252   C                                                                                      AT 100b
   0253         Open (5,file=WeatherFile,status='old',ERR=10)                                    AT 100b
   0254         im=im+1                                                                          AT 10b9
   0255         il=il+1                                                                          AT 10b9
   0256         Read (5,*,ERR=10)                                                                AT 10b9
   0257         im=im+1                                                                          AT 111c
   0258         il=il+1                                                                          AT 111c
   0259         Read (5,*,ERR=10)                                                                AT 111c
   0260   1111  il=il+1                                                                          AT 1153
   0261         Read (5,*,ERR=10) iDum, date, iDum                                               AT 116c
   0262         MDAY=julday(date)                                                                AT 11e6
   0263   C       MDAY = 38065                                                                   AT 1201
   0264   cdt changed from LE to LT since jday was always gt. time                               AT 1201
   0265         If (MDAY.LT.JDFRST) GO TO 1111                                                   AT 1201
   0266         backspace(5)                                                                     AT 1210
   0267                                                                                          AT 12b6
   0268   C                                                                                      AT 12b6
   0269   C   CALCULATE A CLOUD COVER FACTOR FOR THIS LATITUDE                                   AT 12b6
   0270   C                                                                                      AT 12b6
   0271         If (LATUDE.LE.25.0) THEN                                                         AT 12b6
   0272             CLDFAC = 0.45 - (LATUDE*0.004)                                               AT 12b6
   0273         Else                                                                             AT 12b6
   0274             CLDFAC = 0.30 + (LATUDE*0.002)                                               AT 12b6
   0275         Endif                                                                            AT 12b6
   0276   c                                                                                      AT 12b6
   0277   c..................... Routine calculations                                            AT 12b6
   0278                                                                                          AT 12b6
   0279                                                                                          AT 12b6
   0280   c..................... Input daily data                                                AT 12b6
   0281      11 If((linput.eq.1).OR.idint(t+St).eq.(JDAY+1)) then                                AT 12b6
   0282                                                                                          AT 1315
   0283         tAtm=t          !insure we call the weather code the next step                   AT 1315
   0284                                                                                          AT 1315
   0285   c       Do i=1,NumNP                                                                   AT 1315
   0286   c        CodeW(i)=PcodeW(i)                                                            AT 1315
   0287   c         Enddo                                                                        AT 1315
   0288                                                                                          AT 1315
   0289   c                                                                                      AT 1315
   0290   c ZEROING DAILY ARRAYS                                                                 AT 1315
   0291   c                                                                                      AT 1315
   0292           Do i=1,24                                                                      AT 1315
   0293             RINT(i)=0.                                                                   AT 133f
   0294             RADINT(i)=0.                                                                 AT 1369
   0295             WATTSM(i)=0.                                                                 AT 1393
   0296             il=il-1                                                                      AT 13cc
   0297           Enddo                                                                          AT 13cc
   0298   c                                                                                      AT 13e4
   0299   c Read meteodata                                                                       AT 13e4
   0300   c                                                                                      AT 13e4
   0301           Do m=1,24                                                                      AT 13e4
   0302             il=il+1                                                                      AT 141a
   0303   C          Read(5,*,ERR=10) JDAY,HOUR, DATE1, (CLIMAT(i),i=1,NCD)                      AT 141a
   0304             Read(5,*,ERR=10) JDAY, date, HOUR,  (CLIMAT(i),i=1,NCD)                      AT 141a
   0305              JDAY=julday(date)                                                           AT 150c
   0306   c    SInce some routines need the day of the calendar year we need a variable to hold this AT 152e
   0307   C    since the julian day is referenced to a time longer in the past                   AT 152e
   0308              ThisYear=CurYear(date)                                                      AT 152e
   0309              write (date,'("01/01/",i4.4)') ThisYear                                     AT 1549
   0310              DayOfYear=JDAY-julday(date)                                                 AT 15ad
   0311                                                                                          AT 15e8
   0312              HSR(M)=max(0.0,climat(1))*BSOLAR/3600  ! convert to watts m-2 hard          AT 15e8
   0313                                             !coded for hourly now                        AT 1654
   0314                                                                                          AT 1654
   0315              if (lInput.ne.1) HTEMPY(M)=HTEMP(M)  ! save to yesterday's                  AT 1654
   0316                                                   !temperature                           AT 16a5
   0317              HTEMP(M)=(climat(2)-ATEMP)/BTEMP     ! convert to celcius                   AT 16a5
   0318              HRAIN(M) = CLIMAT(3)*erain         ! convert to cm rain in                  AT 16eb
   0319                                                 ! this hour                              AT 1738
   0320              If (MSW2.gt.0) HWIND(M)=CLIMAT(4)                                           AT 1738
   0321              If(MSW6.gt.0) then                                                          AT 1783
   0322                Rel_Humid(m)=Min(Climat(3+2*MSW1+MSW2+ISOL+MSW6)                          AT 1783
   0323        #              /100.,0.98)                                                        AT 1783
   0324               endif                                                                      AT 17ee
   0325            enddo                                                                         AT 17ee
   0326                                                                                          AT 1887
   0327          If(MSW7.gt.0) then                                                              AT 1887
   0328             CO2=Climat(4+2*MSW1+MSW2+MSW3+ISOL*MSW4+MSW6+MSW7)                           AT 1887
   0329          EndIf                                                                           AT 1887
   0330                                                                                          AT 1887
   0331                                                                                          AT 1887
   0332   C                                                                                      AT 1887
   0333   C      ADJUST UNITS FOR HOURLY DATA                                                    AT 1887
   0334   c      HSR(M) is converted to an hours worth of Watts m-2 (Joules m-2 h-1)             AT 1887
   0335   C                                                                                      AT 1887
   0336   202          RI = 0.0                                                                  AT 1887
D:\2DSOIL_Grape\Soil Source\hourwea.for(336) : warning 21 - Label 202 is declared, but not used 
   0337             SUM24 = 0.0                                                                  AT 18a1
   0338             TMAX = 0.0                                                                   AT 18b4
   0339             TMIN = 1000.0                                                                AT 18c7
   0340             DO 1015 M = 1,24                                                             AT 18da
   0341   c RI should be total J m-2 -- work in Watts * time = total energy                      AT 18ff
   0342               RI = RI + amax1(0.0,HSR(M))*3600                                           AT 18ff
   0343                SUM24 = SUM24 + HRAIN(M)                                                  AT 1952
   0344                IF(TMAX .LT. HTEMP(M)) THEN                                               AT 1987
   0345                  TMAX = HTEMP(M)                                                         AT 19be
   0346                ENDIF                                                                     AT 19e1
   0347                IF(TMIN .GT. HTEMP(M)) THEN                                               AT 19f0
   0348                  TMIN = HTEMP(M)                                                         AT 1a27
   0349                ENDIF                                                                     AT 1a4a
   0350                IF(MSW2 .GT. 0) THEN                                                      AT 1a71
   0351                  WIND = HWIND(M) * BWIND                                                 AT 1a71
   0352                Else                                                                      AT 1aaa
   0353                  WIND=WINDA*BWIND                                                        AT 1acf
   0354                ENDIF                                                                     AT 1acf
   0355   1015      CONTINUE                                                                     AT 1acf
   0356             RAIN = SUM24                                                                 AT 1bc2
   0357           If (MSW1.GT.0) then                                                            AT 1bc2
   0358             TWET = (CLIMAT(5+MSW2) - ATEMP)/BTEMP                                        AT 1bc2
   0359             TDRY = (CLIMAT(6+MSW2) - ATEMP)/BTEMP                                        AT 1bc2
   0360           Endif                                                                          AT 1bc2
   0361           If (MSW4.GT.0.AND.NumSol.ne.0) then                                            AT 1bc2
   0362             Do i=1,NumSol                                                                AT 1bc2
   0363               CPREC(i)=CLIMAT(4+MSW2+2*MSW1+MSW3+i)                                      AT 1bef
   0364             Enddo                                                                        AT 1c3d
   0365           Endif                                                                          AT 1c7e
   0366                                                                                          AT 1c7e
   0367                                                                                          AT 1c7e
   0368                                                                                          AT 1c7e
   0369   c......................... Radiation submodel                                          AT 1c7e
   0370   C                                                                                      AT 1c7e
   0371   C  CALCULATE SOLAR DECLINATION                                                         AT 1c7e
   0372   C                                                                                      AT 1c7e
   0373           XLAT = LATUDE*DEGRAD  !convert to radians                                      AT 1c7e
   0374           DEC = SDERP(1)                                                                 AT 1c7e
   0375           Do I = 2,5                                                                     AT 1c91
   0376             N = I - 1                                                                    AT 1ca0
   0377             J = I + 4                                                                    AT 1cb0
   0378             D11 = N*0.01721*JDAY                                                         AT 1cc4
   0379             DEC = DEC + SDERP(I)*SIN(D11) + SDERP(J)*COS(D11)                            AT 1cf8
   0380           Enddo                                                                          AT 1d64
   0381           DEC = DEC*DEGRAD                                                               AT 1d7c
   0382   C                                                                                      AT 1d99
   0383   C  CALCULATE SOME PARTS OF THE SOLAR RADIATION EQUATIONS THAT                          AT 1d99
   0384   C         OCCUR REPEATEDLY LATER                                                       AT 1d99
   0385   C                                                                                      AT 1d99
   0386           D12 = SIN(XLAT)*SIN(DEC)                                                       AT 1d99
   0387           D13 = COS(XLAT)*COS(DEC)                                                       AT 1ddc
   0388           D14 = D12 + D13                                                                AT 1e1f
   0389   C                                                                                      AT 1e2e
   0390   C  CALCULATE DAYLENGTH                                                                 AT 1e2e
   0391   C                                                                                      AT 1e2e
   0392           DAYLNG = ACOS((-0.014544 - D12)/D13)*7.6394                                    AT 1e2e
   0393   C       7.6394 = 180/3.1416/360*24*2                                                   AT 1e6c
   0394   C                                                                                      AT 1e6c
   0395   C  CALCULATE SOLAR RADIATION INCIDENT ON TOP OF THE EARTH'S                            AT 1e6c
   0396   C         ATMOSPHERE AT SOLAR NOON                                                     AT 1e6c
   0397   C                                                                                      AT 1e6c
   0398           RADVEC = 1 + (0.01674*SIN((DayOfYear - 93.5)*0.9863*DEGRAD))                   AT 1e6c
   0399           WATATM = 1325.4*D14/(RADVEC*RADVEC)                                            AT 1ed4
   0400   C                                                                                      AT 1f00
   0401   C  CALCULATE AN ATMOSPHERIC TRANSMISSION COEFFICIENT FOR THIS                          AT 1f00
   0402   C         LATITUDE AND TIME OF YEAR. ***                                               AT 1f00
   0403   C                                                                                      AT 1f00
   0404           If (DayOfYear.LT.145) then                                                     AT 1f00
   0405             ATRANS = 0.68 + ((5.25E-5*LATUDE) - 0.1E-3)*(145 - DayOfYear)                AT 1f0d
   0406           Else If (DayOfYear.LE.237) then                                                AT 1f65
   0407             ATRANS = 0.68                                                                AT 1f76
   0408           Else                                                                           AT 1f8e
   0409             If (LATUDE.LE.30.0) then                                                     AT 200c
   0410               D15 = (LATUDE*5.5E-5) - 0.1E-3                                             AT 200c
   0411             Else                                                                         AT 200c
   0412               D15 = 0.65E-3 + (LATUDE*3.0E-5)                                            AT 200c
   0413             Endif                                                                        AT 200c
   0414             ATRANS = 0.68 + D15*(DayOfYear - 237)                                        AT 200c
   0415           Endif                                                                          AT 203e
   0416   C                                                                                      AT 203e
   0417   C  CALCULATE POTENTIAL DIRECT + DIfFUSE RADIATION INCIDENT ON                          AT 203e
   0418   C         CROP AT SOLAR NOON                                                           AT 203e
   0419   C                                                                                      AT 203e
   0420           WATPOT = WATATM*0.5*(0.93 - (0.02/D14) + ATRANS**(1/D14))                      AT 203e
   0421                                                                                          AT 2228
   0422   C                                                                                      AT 2228
   0423   C  CALCULATE ACTUAL RADIATION INCIDENT ON CROP AT SOLAR NOON                           AT 2228
   0424   C  GIVEN DAILY INTEGRAL AND ASSUMING RADIATION FLUX DENSITY                            AT 2228
   0425   C  VARIES AS A HALF SINE WAVE OVER THE PHOTOPERIOD                                     AT 2228
   0426   C  Dividing by daylength and 3600 converts from MJ to watts                            AT 2228
   0427   C                                                                                      AT 2228
   0428           WATACT = RI*4.363E-4/DAYLNG     ! Watts per m2                                 AT 2228
   0429   C       4.363E-4 = 3.1416/3600/2                                                       AT 2228
   0430   C                                                                                      AT 2228
   0431   C  CALCULATE CLOUD COVER. ***                                                          AT 2228
   0432   C                                                                                      AT 2228
   0433           WATRAT = WATACT/WATPOT                                                         AT 2228
   0434           If (WATRAT.GE.1.0) then                                                        AT 2228
   0435             CLOUD = 0.0                                                                  AT 2228
   0436           Else                                                                           AT 2228
   0437             CLOUD =(CLDFAC - SQRT((CLDFAC*CLDFAC) + (1.52*(1 - WATRAT))))                AT 2228
   0438        &   /(-0.76)                                                                      AT 2228
   0439   C        1.52 = 4*0.38                                                                 AT 2228
   0440   C        0.76 = 2*0.38                                                                 AT 2228
   0441             If (CLOUD.GE.1.0) CLOUD = 1.0                                                AT 2228
   0442           Endif                                                                          AT 2228
   0443   C                                                                                      AT 2228
   0444   C       DUSK AND DAWN                                                                  AT 2228
   0445   C                                                                                      AT 2228
   0446           DAWN = 12.0 - (DAYLNG/2.0)                                                     AT 2228
D:\2DSOIL_Grape\Soil Source\hourwea.for(446) : warning 242 - Variable DAWN has been given a value but never used 
   0447           DUSK = 12.0 + (DAYLNG/2.0)                                                     AT 2228
   0448   C                                                                                      AT 2228
   0449   C  CALCULATE TOTAL RADIATION INCIDENT ON THE CROP AT EACH TIME                         AT 2228
   0450   C                                                                                      AT 2228
   0451   C  DIVIDE PHOTOPERIOD INTO IPERD EQUAL INCREMENTS AND CALCULATE                        AT 2228
   0452   C  HOUR ANGLES BETWEEN THE MIDPOINTS AND SOLAR NOON                                    AT 2228
   0453   C                                                                                      AT 2228
D:\2DSOIL_Grape\Soil Source\hourwea.for(447) : warning 242 - Variable DUSK has been given a value but never used 
   0454           IHPERD = IPERD/2                                                               AT 2228
   0455           Do 20, J = 1,IHPERD                                                            AT 2243
   0456             HRANG(J) = PI/12.0*(12 - J + 0.5)                                            AT 2270
   0457    20     HRANG(IPERD - J + 1) = HRANG(J)                                                AT 22c0
   0458           DDIf = DAYLNG - (2.0*IfIX(DAYLNG/2))                                           AT 237f
   0459           IUP = 13 - IfIX(DAYLNG/2)                                                      AT 237f
   0460           IDN = 12 + (13 - IUP)                                                          AT 237f
   0461           If (.NOT.((DDIf.GT.0.0).OR.(DDIf.LT.0.0)))then                                 AT 2392
   0462             IDAWN = IUP                                                                  AT 23e3
   0463             IDUSK = IDN                                                                  AT 23e3
   0464           Else                                                                           AT 23e3
   0465             IDAWN = IUP - 1                                                              AT 23e3
   0466             IDUSK = IDN + 1                                                              AT 23fb
   0467           ENDIf                                                                          AT 240e
   0468   C                                                                                      AT 240e
   0469   C  CALCULATE TOTAL RADIATION INCIDENT ON THE CROP AT EACH TIME                         AT 240e
   0470   C                                                                                      AT 240e
   0471           Do I = 1,IPERD                                                                 AT 240e
   0472             TIMH = I - 0.5                                                               AT 2440
D:\2DSOIL_Grape\Soil Source\hourwea.for(472) : warning 242 - Variable TIMH has been given a value but never used 
   0473             WATTSM(I) = 0.0                                                              AT 246f
   0474             If(I.GE.IUP.AND.I.LE.IDN)                                                    AT 2489
   0475   cd   HSR is watts                                                                      AT 2489
   0476        &      WATTSM(I) = HSR(I)                                                         AT 2489
   0477           Enddo                                                                          AT 250b
   0478           If ((DDIf.GT.0.0).OR.(DDIf.LT.0.0)) then                                       AT 2526
   0479              WATTSM(IDAWN) = HSR(IDAWN)                                                  AT 25ff
   0480              WATTSM(IDUSK) = HSR(IDUSK)                                                  AT 25ff
   0481           ENDIf                                                                          AT 25ff
   0482                                                                                          AT 25ff
   0483   c..................... Temperature and vapour pressure submodel                        AT 25ff
   0484                                                                                          AT 25ff
   0485                                                                                          AT 25ff
   0486   C                                                                                      AT 25ff
   0487   C  ASSIGN AIR TEMPERATURE AT EACH TIME                                                 AT 25ff
   0488   C                                                                                      AT 25ff
   0489   C FIND THE TIME AFTER DAWN IN HOURS WHEN MAXIMUM                                       AT 25ff
   0490   C  TEMPERATURE IS REACHED                                                              AT 25ff
   0491   C                                                                                      AT 25ff
   0492           tMax=-1e6                                                                      AT 25ff
   0493           Do 70, m = 1,IPERD                                                             AT 2612
   0494              TAIR(M) = (HTEMP(M)-ATEMP)/BTEMP                                            AT 264f
   0495              if(m.eq.IDUSK) TDUSK=TAIR(m)                                                AT 26d8
   0496              if (TAIR(M).GT.TMAX) then                                                   AT 270a
   0497                TMAX=TAIR(m)                                                              AT 2741
   0498                TMAXHR=m                                                                  AT 2764
D:\2DSOIL_Grape\Soil Source\hourwea.for(498) : warning 242 - Variable TMAXHR has been given a value but never used 
   0499               End If                                                                     AT 277b
   0500    70   CONTINUE                                                                         AT 277b
   0501                                                                                          AT 27c9
   0502                                                                                          AT 27c9
   0503   C                                                                                      AT 27c9
   0504   C  If DAILY WET BULB TEMPERATURES ARE NOT AVAILABLE, ASSUME                            AT 27c9
   0505   C  MINIMUM TEMPERATURE = DEW POINT TEMPERATURE AND CALCULATE                           AT 27c9
   0506   C  WATER VAPOR PRESSURE.  ASSUME A VALUE FOR THE PSYCHROMETRIC                         AT 27c9
   0507   C  "CONSTANT"                                                                          AT 27c9
   0508   C                                                                                      AT 27c9
   0509   cdt added msw6 to if statement here                                                    AT 27c9
   0510                                                                                          AT 27c9
   0511           If (MSW1.NE.1.and.MSW6.eq.0) then                                              AT 27c9
   0512             Do i=1,iperd                                                                 AT 27c9
   0513               AVP(i) = 0.61*EXP((17.27*TMIN)/(TMIN + 237.3))                             AT 27ff
   0514              enddo                                                                       AT 2865
   0515             GAMMA = 0.0645                                                               AT 2904
   0516           Else                                                                           AT 2904
   0517   cdt                                                                                    AT 2904
   0518              if(MSW1.eq.1) then                                                          AT 2904
   0519   C                                                                                      AT 2904
   0520   C  SINCE DAILY WET BULB TEMPERATURES ARE AVAILABLE CALCULATE                           AT 2904
   0521   C  SATURATION VAPOR PRESSURE AT THE WET BULB TEMPERATURES                              AT 2904
   0522   C    http://www.pmel.org/HandBook/HBpage21.htm see this site for more info             AT 2904
   0523   C    on using Dewpoint to calculate RH                                                 AT 2904
   0524   C                                                                                      AT 2904
   0525             SVPW = 0.61*EXP((17.27*TWET)/(TWET + 237.3))                                 AT 2904
   0526   C                                                                                      AT 2904
   0527   C  CALCULATE THE HUMIDITY RATIO, D31, LATENT HEAT OF EVAPORATION,                      AT 2904
   0528   C  D32 AND THE PSYCHROMETRIC "CONSTANT"                                                AT 2904
   0529   C                                                                                      AT 2904
   0530             D31 = 0.622*(SVPW/(101.3 - SVPW))                                            AT 2904
   0531             D32 = 2500.8 - (2.37*TWET)                                                   AT 2962
   0532             GAMMA = 0.62*(1.006 + (1.846*D31))                                           AT 2962
   0533        &   /((0.622 + D31)*(0.622 + D31)*D32)*101.3                                      AT 2962
   0534   C                                                                                      AT 29bc
   0535   C  CALCULATE ACTUAL WATER VAPOR PRESSURE                                               AT 29bc
   0536   C                                                                                      AT 29bc
   0537             Do i=1,iperd                                                                 AT 29bc
   0538                AVP(i) = SVPW - (GAMMA*(TDRY - TWET))                                     AT 29ff
   0539             enddo                                                                        AT 2a50
   0540           Endif                                                                          AT 2a85
   0541                                                                                          AT 2a85
   0542   CDT                                                                                    AT 2a85
   0543               if(MSW6.eq.1) then                                                         AT 2a85
   0544                Do i=1,iperd                                                              AT 2a85
   0545                   TMean=(TMax+TMin)/2.0                                                  AT 2ab0
D:\2DSOIL_Grape\Soil Source\hourwea.for(545) : warning 242 - Variable TMEAN has been given a value but never used 
   0546                   SVPW= 0.61*EXP((17.27*HTEMP(i))/(HTEMP(i) + 237.3))                    AT 2ae6
   0547                   D31 = 0.622*(SVPW/(101.3 - SVPW))                                      AT 2b3b
   0548                   D32 = 2500.8 - (2.37*HTEMP(i))                                         AT 2b72
   0549                   GAMMA = 0.62*(1.006 + (1.846*D31))                                     AT 2bb0
   0550        &          /((0.622 + D31)*(0.622 + D31)*D32)*101.3                               AT 2bb0
   0551                   AVP(i)= Rel_Humid(i)*SVPW                                              AT 2c19
   0552                 enddo                                                                    AT 2c65
   0553             endif                                                                        AT 2c82
   0554                                                                                          AT 2c82
   0555           Endif                                                                          AT 2c82
   0556   CDT                                                                                    AT 2c82
   0557   C                                                                                      AT 2c82
   0558   C  CALCULATE WATER STAURATION VAPOR PRESSURE AT AIR TEMPERATURE                        AT 2c82
   0559   C  AND THE SLOPE OF THE RELATIONSHIP AT THAT POINT                                     AT 2c82
   0560   C                                                                                      AT 2c82
   0561           Do 80, I = 1,IPERD                                                             AT 2c82
   0562             SVPA = 0.61*EXP((17.27*TAIR(I))/(TAIR(I) + 237.3))                           AT 2cbf
   0563             DEL(I) = (0.61*EXP((17.27*(TAIR(I) + 1.))                                    AT 2d23
   0564        &   /(TAIR(I) + 1.0 + 237.3))) - SVPA                                             AT 2d23
   0565   C                                                                                      AT 2dc8
   0566   C  CALCULATE WATER VAPOR PRESSURE DEFICIT                                              AT 2dc8
   0567   C                                                                                      AT 2dc8
   0568             VPD(I) = SVPA - AVP(I)                                                       AT 2dc8
   0569             If (VPD(I).LE.0.0) VPD(I) = 0.0                                              AT 2e27
   0570    80     Continue                                                                       AT 2e7f
   0571                                                                                          AT 2eb3
   0572   c....................Light interception submodel                                       AT 2eb3
   0573                                                                                          AT 2eb3
   0574           If(NShoot.ne.0) then                                                           AT 2eb3
   0575   C                                                                                      AT 2eb3
   0576   C  CALCULATE SOLAR ALTITUDE AND SOLAR AZIMUTH FOR EACH TIME                            AT 2eb3
   0577   C                                                                                      AT 2eb3
   0578             Do 30 I = 1,IPERD                                                            AT 2eb3
   0579               SINALT(I) = D12 + (D13*COS(HRANG(I)))                                      AT 2ee0
   0580               SOLALT(I) = ASIN(SINALT(I))                                                AT 2f29
   0581               SINAZI(I) = -COS(DEC)*SIN(HRANG(I))/COS(SOLALT(I))                         AT 2f49
   0582    30       Continue                                                                     AT 2fbe
   0583             D18 = 0.0                                                                    AT 2fd9
   0584             Do 60, I = 1,IHPERD                                                          AT 2fec
   0585               SOLAZI(I) = PI + ASIN(SINAZI(I))                                           AT 3020
   0586               If (.NOT.((D18.GT.0.0).OR.(D18.LT.0.0))) then                              AT 3058
   0587                 D19 = HRANG(I) - 0.01                                                    AT 3088
   0588                 TESAZI = PI + ((ASIN(-COS(DEC)*SIN(D19))                                 AT 30ad
   0589        &       /(COS(ASIN(D12 + (D13*COS(D19)))))))                                      AT 30ad
   0590                 If (TESAZI.LT.SOLAZI(I)) then                                            AT 317f
   0591                   SOLAZI(I) = PI - SOLAZI(I)                                             AT 319b
   0592                 Else                                                                     AT 31c9
   0593                   D18 = 1.0                                                              AT 31c9
   0594                 Endif                                                                    AT 31dc
   0595               Endif                                                                      AT 31dc
   0596               SOLAZI(IPERD - I + 1) = TPI - SOLAZI(I)                                    AT 31dc
   0597    60       Continue                                                                     AT 3217
   0598   C                                                                                      AT 3232
   0599   C  CALCULATE PROPORTION OF TOTAL RADIATION THAT IS DIFFUSE AT                          AT 3232
   0600   C  EACH TIME                                                                           AT 3232
   0601   C                                                                                      AT 3232
   0602             Do 40 I = 1,IPERD                                                            AT 3232
   0603               D16 = SINALT(I)                                                            AT 3260
   0604               If (D16.LT.0.01) then                                                      AT 327c
   0605                 DIFWAT(I) = 1.0                                                          AT 3299
   0606               Else                                                                       AT 32c0
   0607                 D17 = (0.93 - (0.02/D16) - ATRANS**(1/D16))                              AT 32c0
   0608        &       /(0.93 - (0.02/D16) + ATRANS**(1/D16))                                    AT 32c0
   0609                 If (CLOUD.GT.0.0) then                                                   AT 33a2
   0610                   DIFWAT(I) = 1.0 - ((1.0 - D17)*(1.0 - CLOUD)                           AT 33a2
   0611        &         /(1.0 - ((CLDFAC+(0.38*CLOUD))*CLOUD)))                                 AT 33a2
   0612                 Else                                                                     AT 3452
   0613                   DIFWAT(I) = D17                                                        AT 3452
   0614                 Endif                                                                    AT 3475
   0615                 If (DIFWAT(I).LT.0.0) DIFWAT(I) = 0.0                                    AT 347d
   0616                 If (DIFWAT(I).GT.1.0) DIFWAT(I) = 1.0                                    AT 34e4
   0617               Endif                                                                      AT 353c
   0618   C                                                                                      AT 354b
   0619   C     *** CALCULATE PHOTOSYNTHETICALLY ACTIVE RADIATION (PAR)                          AT 354b
   0620   C         INCIDENT ON THE CROP ASSUMING THAT                                           AT 354b
   0621   C         PAR = 0.43 DIRECT + 0.57 DIFFUSE RADIATION. ***                              AT 354b
   0622   C                                                                                      AT 354b
   0623              PAR(I) = WATTSM(I)                                                          AT 354b
   0624        &          *((DIFWAT(I)*0.57) + ((1.0 - DIFWAT(I))*0.43))                         AT 354b
   0625   40         CONTINUE                                                                    AT 35dc
   0626   C                                                                                      AT 3616
   0627   C                                                                                      AT 3616
   0628   C  If CLOUD COVER IS COMPLETE, OMIT CALCULATIONS PERTAINING                            AT 3616
   0629   C  TO DIRECT RADIATION INTERCEPTION                                                    AT 3616
   0630   C                                                                                      AT 3616
   0631                                                                                          AT 3616
   0632             If (CLOUD.GE.1.0) then                                                       AT 3616
   0633               Do I = 1,IPERD                                                             AT 3616
   0634                 DIRINT(I) = 0.0                                                          AT 364f
   0635               Enddo                                                                      AT 3671
   0636             Endif                                                                        AT 368e
   0637   C                                                                                      AT 368e
   0638   C  CALCULATE ANGLE BETWEEN ROW AND SOLAR AZIMUTH FOR EACH TIME                         AT 368e
   0639   C                                                                                      AT 368e
   0640             Do I = 1,IPERD                                                               AT 368e
   0641               SARANG(I) = ABS(SOLAZI(I) - (ROWANG*DEGRAD))                               AT 36c0
   0642               If (SARANG(I).GT.3.*PI/2.) SARANG(I)                                       AT 3708
   0643        &       = ABS(SARANG(I) - TPI)                                                    AT 3708
   0644               If (SARANG(I).GT.PI/2.) SARANG(I)                                          AT 3760
   0645        &       = ABS(SARANG(I) - PI)                                                     AT 3760
   0646   C                                                                                      AT 37c6
   0647   C  CALCULATE PROPORTION OF DIRECT RADIATION INTERCEPTED BY ROWS                        AT 37c6
   0648   C  OF PLANTS ASSUMING THEY ARE OPAQUE CYLINDERS                                        AT 37c6
   0649   C                                                                                      AT 37c6
   0650               SHADOW(I) = HEIGHT/SIN(ATAN(TAN(SOLALT(I))                                 AT 37c6
   0651        &     /SIN(SARANG(I))))                                                           AT 37c6
   0652               DIRINT(I) = SHADOW(I)/ROWSP                                                AT 3894
   0653               If (DIRINT(I).GT.1.0) DIRINT(I) = 1.0                                      AT 38e8
   0654               If (DIRINT(I).LT.0.0) DIRINT(I) = 0.0                                      AT 394f
   0655             Enddo                                                                        AT 39a7
   0656                                                                                          AT 39c2
   0657                                                                                          AT 39c2
   0658   C                                                                                      AT 39c2
   0659   C  CALCULATE PROPORTION OF DIfFUSE RADIATION INTERCEPTED BY ROWS                       AT 39c2
   0660   C  OF PLANTS ASSUMING THEY ARE OPAQUE CYLINDERS                                        AT 39c2
   0661   C  FIRST DIVIDE ROWSPACING INTO 20 EQUAL PARTS AND FIND THE                            AT 39c2
   0662   C  MIDPOINTS FROM ROW TO MID ROW                                                       AT 39c2
   0663   C                                                                                      AT 39c2
   0664             DIfFIN = 0.0                                                                 AT 39c2
   0665             Do I = 1,10                                                                  AT 39d5
   0666               ROWINC(I) = ROWSP/20.0*(I - 0.5)                                           AT 39ff
   0667   C                                                                                      AT 3a5d
   0668   C  CALCULATE PROPORTION OF SKY OBSCURED BY "OPAQUE" ROWS AT EACH                       AT 3a5d
   0669   C  POSITION FROM ROW TO MID-ROW                                                        AT 3a5d
   0670   C                                                                                      AT 3a5d
   0671               DIfINT(I) = (ATAN(HEIGHT/2.0/(ROWSP - ROWINC(I)))                          AT 3a5d
   0672        &     +ATAN(HEIGHT/2.0/ROWINC(I)))/1.5708                                         AT 3a5d
   0673               If (DIfINT(I).GT.1.0) DIfINT(I) = 1.0                                      AT 3b35
   0674   C                                                                                      AT 3b9c
   0675   C  INTEGRATE DIfFUSE RADIATION INTERCEPTION ACROSS THE ROW. ***                        AT 3b9c
   0676   C                                                                                      AT 3b9c
   0677               DIfFIN = DIfFIN + DIfINT(I)                                                AT 3b9c
   0678             Enddo                                                                        AT 3bc9
   0679   c                                                                                      AT 3be1
   0680             DIfFIN = DIfFIN/10.0                                                         AT 3be1
   0681   C                                                                                      AT 3c1e
   0682   C  CALCULATE LEAF AREA PER UNIT GROUND AREA COVERED BY CROP                            AT 3c1e
   0683   C  CANOPY                                                                              AT 3c1e
   0684   C                                                                                      AT 3c1e
   0685   C                                                                                      AT 3c1e
   0686                                                                                          AT 3c1e
   0687   C  CALCULATE AN EFFECTIVE LCAI ALLOWING FOR THE FACT THAT LIGHT                        AT 3c1e
   0688   C  AT A LOW ANGLE TRAVERSES MORE LEAF LAYERS TO REACH THE SOIL                         AT 3c1e
   0689   C                                                                                      AT 3c1e
   0690                                                                                          AT 3c1e
   0691                                                                                          AT 3c1e
   0692              LCAI=LAI                                                                    AT 3c1e
   0693                                                                                          AT 3c1e
   0694             Do 50, I = 1,IPERD                                                           AT 3c1e
   0695               If (SOLALT(I).GT.0.0) then                                                 AT 3c50
   0696                 ELCAI = LCAI/(SIN(ACOS(COS(SARANG(I))                                    AT 3c70
   0697        &       *COS(SOLALT(I)))))                                                        AT 3c70
   0698                 If (SHADOW(I).GT.ROWSP)                                                  AT 3d19
   0699        &           ELCAI = ELCAI*SHADOW(I)/ROWSP                                         AT 3d19
   0700   C                                                                                      AT 3e06
   0701   C  CALCULATE BEERS LAW CORRECTION FOR RADIATION INTERCEPTION                           AT 3e06
   0702   C                                                                                      AT 3e06
   0703                 If((ELCAI*CEC).LE.88.0) then                                             AT 3e06
   0704                   BEERS = (1 - EXP(-ELCAI*CEC))                                          AT 3e06
   0705                 Else                                                                     AT 3e06
   0706                   BEERS=1.0                                                              AT 3e06
   0707                 Endif                                                                    AT 3e19
   0708                                                                                          AT 3e28
   0709   C  CALCULATE PROPORTION OF PHOTOSYNTHETICALLY ACTIVE RADIATION                         AT 3e28
   0710   C   (PAR) INTERCEPTED BY THE CROP CANOPY ASSUMING THAT                                 AT 3e28
   0711   C    PAR = 0.43 DIRECT + 0.57 DIFFUSE RADIATION. ***                                   AT 3e28
   0712                                                                                          AT 3e28
   0713         PARINT(I) = WATTSM(I)*((DIFFIN*0.57*DIFWAT(I))                                   AT 3e28
   0714        &     + (DIRINT(I)*0.43*(1.0 - DIFWAT(I))))                                       AT 3e28
   0715        &     /PAR(I)*BEERS                                                               AT 3e28
   0716   C                                                                                      AT 3f12
   0717   C  CALCULATE PROPORTION OF TOTAL RADIATION INTERCEPTED BY THE                          AT 3f12
   0718   C  CROP CANOPY                                                                         AT 3f12
   0719   C                                                                                      AT 3f12
   0720                 RADINT(I) = ((DIfFIN*DIfWAT(I)) + (DIRINT(I)                             AT 3f12
   0721        &         *(1.0 - DIfWAT(I))))*BEERS                                              AT 3f12
   0722               Else If (WATTSM(I).GT.0.0) then                                            AT 3fa5
   0723                 BEERS = (1 - EXP(-LCAI*CEC))                                             AT 4040
   0724                 PARINT(I) = COVER*BEERS                                                  AT 4040
   0725                 RADINT(I) = COVER*BEERS                                                  AT 407c
   0726               Else                                                                       AT 40b8
   0727                  PARINT(I) = 0.0                                                         AT 40c7
   0728                  RADINT(I) = 0.0                                                         AT 40f1
   0729               Endif                                                                      AT 4113
   0730    50       Continue                                                                     AT 4113
   0731                                                                                          AT 412e
   0732                                                                                          AT 412e
   0733   C                                                                                      AT 412e
   0734   c..................End of radiation interception submodel                              AT 412e
   0735                                                                                          AT 412e
   0736                                                                                          AT 412e
   0737           Endif  !nshoot >0                                                              AT 412e
   0738   C                                                                                      AT 412e
   0739   c..................Daily calculations for the precipitation                            AT 412e
   0740   C                                                                                      AT 412e
   0741             Do i=1,24                                                                    AT 412e
   0742               RINT(i)=HRain(i)*24.0  ! scale hourly rainfall to a daily rate             AT 414f
   0743             Enddo                                                                        AT 41a1
   0744                                                                                          AT 420c
   0745           If(Rain.lt.0.) then                                                            AT 420c
   0746             QF=QF-Rain                                                                   AT 420c
   0747             Do i=1,NumFP                                                                 AT 420c
   0748               k=NumF(i)                                                                  AT 423f
   0749               CodeW(k)=1                                                                 AT 426d
   0750               hNew(k)=hFur(i)                                                            AT 4292
   0751             Enddo                                                                        AT 42cc
   0752             IfUR=1                                                                       AT 42fb
   0753           Endif                                                                          AT 42fb
   0754   c........................End of daily calculations                                     AT 42fb
   0755         Endif                                                                            AT 42fb
   0756   C                                                                                      AT 42fb
   0757   C     Further we have hourly calculations                                              AT 42fb
   0758                                                                                          AT 42fb
   0759   C                                                                                      AT 42fb
   0760   55    If(Abs(Time-tNext(ModNum)).lt.0.001*Step.or.lInput.eq.1) then                    AT 42fb
D:\2DSOIL_Grape\Soil Source\hourwea.for(760) : warning 21 - Label 55 is declared, but not used 
   0761          ITIME=Idint(dMOD(t+St,1.D0)/PERIOD+1)                                           AT 4378
   0762          if(itime.eq.10) then                                                            AT 43cd
   0763           iii=1;                                                                         AT 43cd
D:\2DSOIL_Grape\Soil Source\hourwea.for(763) : warning 242 - Variable III has been given a value but never used 
   0764           endif                                                                          AT 43d8
   0765                                                                                          AT 43ef
   0766          Do i=1, NumBP                                                                   AT 43ef
   0767            do j=1, 4                                                                     AT 4410
   0768              if (j.lt.4) VarBW(i,j)=0.0                                                  AT 4420
   0769              VarBT(i,j)=0.0                                                              AT 4487
   0770            Enddo                                                                         AT 44bf
   0771           Enddo                                                                          AT 44d7
   0772                                                                                          AT 44f2
   0773   c       Do i=1,NumNP                                                                   AT 44f2
   0774   c        CodeW(i)=PCodeW(i)                                                            AT 44f2
   0775   c         Enddo                                                                        AT 44f2
   0776                                                                                          AT 44f2
   0777   C                                                                                      AT 44f2
   0778   C  FOR DAYLIGHT PERIODS:                                                               AT 44f2
   0779   C  CALCULATE NET UPWARD LONG-WAVE RADIATION ***                                        AT 44f2
   0780   C                                                                                      AT 44f2
   0781   1000    Continue                                                                       AT 44f2
D:\2DSOIL_Grape\Soil Source\hourwea.for(781) : warning 21 - Label 1000 is declared, but not used 
   0782           If (WATTSM(ITIME).GT.0.0) then                                                 AT 4654
   0783             RNLU = (1.6E-3*WATRAT*(100.0 - TAIR(ITIME)))*697.6                           AT 4654
   0784           Else                                                                           AT 4654
   0785             RNLU=0.                                                                      AT 4654
   0786           ENDIf                                                                          AT 4654
   0787   C                                                                                      AT 4654
   0788   C  NO SHADE IF NO PLANT                                                                AT 4654
   0789   C                                                                                      AT 4654
   0790           If(NShoot.eq.0) then                                                           AT 4654
   0791             SHADE = 0.                                                                   AT 4654
   0792             COVER = 0.                                                                   AT 4654
   0793           ENDIf                                                                          AT 4654
   0794   C                                                                                      AT 4654
   0795   C  CALCULATE POTENTIAL WATER EVAPORATION RATE FROM THE SOIL                            AT 4654
   0796   C  SURFACE                                                                             AT 4654
   0797   C                                                                                      AT 4654
   0798   C  THE TOTAL RADIATION FALLING ON THE SOIL IS ASSUMED TO BE                            AT 4654
   0799   C  CONCENTRATED ON THE EXPOSED SOIL CELLS AND AN EQUIVALENT                            AT 4654
   0800   C  TOTAL RADIATION IS CALCULATED                                                       AT 4654
   0801   C                                                                                      AT 4654
   0802           If (Cover.lt.0.97) then                                                        AT 4654
   0803   C                                                                                      AT 4654
   0804             D11 = WATTSM(ITIME)                                                          AT 4654
   0805                                                                                          AT 4654
   0806           Else                                                                           AT 4654
   0807             D11=0.                                                                       AT 4654
   0808           Endif                                                                          AT 4667
   0809   c                                                                                      AT 4667
   0810   c  MARCH ALONG THE SURFACE TO FIND SOIL-ATMOSPHERE BOUNDARY NODES                      AT 4667
   0811   c  AND THEIR LATERAL COORDINATES                                                       AT 4667
   0812   c                                                                                      AT 4667
   0813           ic=0                                                                           AT 4667
   0814           Do k=1,NumBP                                                                   AT 4688
   0815             i=KXB(k)                                                                     AT 46af
   0816             If(abs(CodeW(i)).eq.4) then                                                  AT 46d6
   0817               ic=ic+1                                                                    AT 4705
   0818               xS(ic)=x(i)                                                                AT 470c
   0819               iS(ic)=i                                                                   AT 4746
   0820               kS(ic)=k                                                                   AT 4756
   0821             Endif                                                                        AT 4766
   0822           Enddo                                                                          AT 4766
   0823           Call SORT03(ic,xS,iS,kS)                                                       AT 4783
   0824   C                                                                                      AT 47a8
   0825           Do 90 i=1,ic                                                                   AT 47a8
   0826             PSh=FSh(i,xBSTEM,SHADE,xS,ic)                                                AT 47d0
   0827   c                                                                                      AT 4812
   0828   c  IF THE NODE IS EXPOSED THEN                                                         AT 4812
   0829   c                                                                                      AT 4812
   0830             If(PSh.gt.0.) then                                                           AT 4812
   0831   C                                                                                      AT 482e
   0832   C  CALCULATE THE ALBEDO OF THE EXPOSED SOIL CELLS                                      AT 482e
   0833   C                                                                                      AT 482e
   0834   cdt changed 0.5 to 0.1                                                                 AT 482e
   0835                 LAMDAS = 0.25 - 0.05*ThNew(iS(i))                                        AT 482e
   0836   C                                                                                      AT 4874
   0837   C  CALCULATE NET RADIATION ON THE EXPOSED SOIL CELLS                                   AT 4874
   0838   C                                                                                      AT 4874
   0839                 RNS = ((1.0 - LAMDAS)*D11) - RNLU                                        AT 4874
   0840                 If(RNS.LE.0.0) RNS = 0.0                                                 AT 4927
   0841   C                                                                                      AT 4927
   0842   C  CALCULATE POTENTIAL EVAPORATION RATE FROM EXPOSED SOIL CELLS                        AT 4927
   0843   C                                                                                      AT 4927
   0844                 D12 = max(1.0,2.0 - (2.0*COVER))                                         AT 4927
   0845                 If (D12.GE.1.0) D12 = 1.0                                                AT 4927
   0846                 ESO = ((DEL(ITIME)/GAMMA*RNS*3600.0/(2500.8                              AT 4a3c
   0847        &     - (2.3668*TAIR(ITIME))))                                                    AT 4a3c
   0848        &     + (VPD(ITIME)*109.375*(1.0 + (0.149*WIND*D12))))                            AT 4a3c
   0849        &      /((DEL(ITIME)/GAMMA) + 1.0)                                                AT 4a3c
   0850   C                                                                                      AT 4a6d
   0851   C   PROPORTIONAL TO THE AREA EXPOSED                                                   AT 4a6d
   0852   C                                                                                      AT 4a6d
   0853                                                                                          AT 4a6d
   0854                 VarBW(kS(i),2)=PSh*24.*ESO/10000.                                        AT 4a6d
   0855   c                                                                                      AT 4aaf
   0856   c  ELSE IF THE NODE IS COVERED                                                         AT 4aaf
   0857   c                                                                                      AT 4aaf
   0858             Else                                                                         AT 4aaf
   0859               VarBW(kS(i),2)=0.05*24.*ESO/10000.                                         AT 4abe
   0860             Endif                                                                        AT 4afb
   0861   c                Endif for the surface nodes                                           AT 4afb
   0862    90     Continue                                                                       AT 4afb
   0863   C                                                                                      AT 4c1f
   0864   C........................ End evaporation                                              AT 4c1f
   0865   C                                                                                      AT 4c1f
   0866   C........................ Transpiration                                                AT 4c1f
   0867   C                                                                                      AT 4c1f
   0868           If (NShoot.ne.0) then                                                          AT 4c1f
   0869   C                                                                                      AT 4c1f
   0870   C  CALCULATE A CROP SURFACE ROUGHNESS PARAMETER                                        AT 4c1f
   0871   C                                                                                      AT 4c1f
   0872           If (ITIME.EQ.1) then                                                           AT 4c1f
   0873              ROUGH = 1.0/(ABS((HEIGHT/ROWSP) - 0.5) + 0.5)                               AT 4c1f
   0874              If (ROUGH.LT.1.0) ROUGH = 1.0                                               AT 4c1f
   0875           Endif                                                                          AT 4c1f
   0876   C                                                                                      AT 4c1f
   0877   C   ON STILL HOT DAYS, CONVECTION CURRENTS AT CROP LEVEL ASSURE                        AT 4c1f
   0878   C   SOME AIR MOVEMENT                                                                  AT 4c1f
   0879   C                                                                                      AT 4c1f
   0880           WINDL = WIND                                                                   AT 4c1f
   0881           If (TAIR(ITIME).GT.25.0.AND.WINDL.LE.0.36) WINDL = 0.36                        AT 4c1f
   0882   C                                                                                      AT 4c4a
   0883   C   CALCULATE POTENTIAL TRANSPIRATION RATE FOR THE CROP                                AT 4c4a
   0884   C                                                                                      AT 4c4a
   0885   C   ASSUME A VALUE FOR THE ALBEDO OF THE CROP                                          AT 4c4a
   0886   C                                                                                      AT 4c4a
   0887           LAMDAC = 0.23                                                                  AT 4c4a
   0888   C                                                                                      AT 4c7d
   0889   C   THE TOTAL RADIATION INTERCEPTED BY THE CROP IS ASSUMED TO BE                       AT 4c7d
   0890   C   SPREAD UNIfORMLY OVER THE AREA COVERED BY THE CROP AND AN                          AT 4c7d
   0891   C   EQUIVALENT TOTAL RADIATION IS CALCULATED                                           AT 4c7d
   0892   C                                                                                      AT 4c7d
   0893   C   CODE TO ACCOUNT FOR THE CASE WHERE THE PLANT                                       AT 4c7d
   0894   C   HAS NOT YET EMERGED AND COVER =0                                                   AT 4c7d
   0895           If (COVER.le.0.) then                                                          AT 4c7d
   0896             WATPL=0.0                                                                    AT 4c7d
   0897           Else                                                                           AT 4c95
   0898             WATPL = WATTSM(ITIME) !*RADINT(ITIME)/COVER /dt don't need when used in 2dsoil AT 4cce
   0899           Endif                                                                          AT 4cce
   0900   C                                                                                      AT 4cce
   0901   C   CALCULATE NET RADIATION ON THE CROP                                                AT 4cce
   0902   C    (RNC already adjusted for cover? - no see two lines above could multiply by radint/cover) AT 4cce
   0903   C                                                                                      AT 4cce
   0904           RNC = ((1.0 - LAMDAC)*WATPL) - RNLU                                            AT 4cce
   0905           If (RNC.LE.0.0) RNC = 0.0                                                      AT 4df2
   0906   C                                                                                      AT 4df2
   0907   C   CALCULATE POTENTIAL TRANSPIRATION RATE (g/m2/hour) FOR CROP ALLOWING FOR           AT 4df2
   0908   C   INCOMPLETE GROUND COVER                                                            AT 4df2
   0909   C                                                                                      AT 4df2
   0910           EPO = ((DEL(ITIME)/GAMMA*RNC*3600.0/(2500.8                                    AT 4df2
   0911        &   - (2.3668*TAIR(ITIME))))                                                      AT 4df2
   0912        &   + (VPD(ITIME)*109.375*(ROUGH +(0.149*WINDL))))                                AT 4df2
   0913        &   /((DEL(ITIME)/GAMMA) + 1.0)                                                   AT 4df2
   0914   C                                                                                      AT 4e69
   0915   C   CODE ADDED TO PREVENT DIVISION BY o                                                AT 4e69
   0916   C                                                                                      AT 4e69
   0917           If (COVER.le.0.0.OR.EPO.LE.0.0) EPO=1.0E-4                                     AT 4e69
   0918   C                                                                                      AT 4e94
   0919   C     *** CALCULATE POTENTIAL TRANSPIRATION RATE FOR AN AVERAGE PLANT **               AT 4e94
   0920   C                                                                                      AT 4e94
   0921   cdt I took out etcorr, the ET correction factor - units are per plant                  AT 4e94
   0922           EO = 24.*EPO*cover/(poprow/rowsp*100)                                          AT 4e94
   0923           If(COVER.le.0.0) then                                                          AT 4f7e
   0924             TPot=0.                                                                      AT 4f7e
   0925           Else                                                                           AT 4f7e
   0926             TPot=EO/COVER                                                                AT 4f7e
   0927           Endif                                                                          AT 4f7e
   0928         Endif                                                                            AT 4f7e
   0929   c................... End Transpiration .................................               AT 4f7e
   0930                                                                                          AT 4f7e
   0931   c................... Precipitation and irrigation                                      AT 4f7e
   0932                                                                                          AT 4f7e
   0933         Do i=1,NumBP                                                                     AT 4f7e
   0934         n=KXB(i)                                                                         AT 4faf
   0935         k=CodeW(n)                                                                       AT 4fd6
   0936         If(K.eq.4.or.K.eq.-4) then                                                       AT 4ff0
   0937            VarBW_old(i,1)=VarBW(i,1)                                                     AT 501d
   0938            VarBW(i,1)=RINT(ITIME)                                                        AT 5067
   0939         If(NumSol.ne.0) then                                                             AT 50de
   0940             do j=1,NumSol                                                                AT 50de
   0941   cdt was varbs(n,j)                                                                     AT 510f
   0942             VarBS(i,j)=CPREC(j)                                                          AT 510f
   0943             Enddo                                                                        AT 516e
   0944          Endif                                                                           AT 5198
   0945   *                                                                                      AT 5198
   0946            VarBW(i,3)=VarBW(i,2)-VarBW(i,1)                                              AT 5198
   0947            Q(n)=-Width(i)*VarBW(i,3)                                                     AT 520a
   0948            If (Q(n).gt.0.0) then                                                         AT 527e
   0949             CodeW(n)=-4                                                                  AT 52b4
   0950             endif                                                                        AT 52cf
   0951          Endif                                                                           AT 52cf
   0952          Enddo                                                                           AT 52cf
   0953   c................... End of the precipitation and irrigation                           AT 53b6
   0954   C ............... Heat Balance is calculated here                                      AT 53b6
   0955   C                                                                                      AT 53b6
   0956   C                                                                                      AT 53b6
   0957   CYAP                                                                                   AT 53b6
   0958   C FCSH is sensible heat flux when the ground is hotter than the air                    AT 53b6
   0959          if(rowsp.le.0) then                                                             AT 53b6
   0960            FCSH=4.0E-3+1.39E-3*Wind                                                      AT 53b6
   0961           else                                                                           AT 53b6
   0962            FCSH=4.0E-3+1.39E-3*Wind*max(1.0,(2.-(2.*height/rowsp*EOMULT)))               AT 53b6
   0963          endif                                                                           AT 53b6
   0964                                                                                          AT 53b6
   0965   c      FCSH=0.02                                                                       AT 53b6
   0966   cdt                                                                                    AT 53b6
   0967   * FELWR is reradiation when soil is warmer than the air.                               AT 53b6
   0968         FCSH=FCSH*4.1856*60.0*24.0                                                       AT 53b6
   0969         FELWR=6.8E-03+9.0E-05*Tair(Itime)                                                AT 540d
   0970         FELWR=FELWR*4.1856*60.0*24.0                                                     AT 540d
   0971   * units are Joules cm-2 d-1 C-1                                                        AT 5420
   0972   CYAPEND                                                                                AT 5420
   0973   C units are changed from cal cm-2 sec-1 C-1 -->J cm-2 d-1 C-1                          AT 5420
   0974         cWat=4.1856                                                                      AT 5420
D:\2DSOIL_Grape\Soil Source\hourwea.for(974) : warning 242 - Variable CWAT has been given a value but never used 
   0975         TairN=Tair(Itime)                                                                AT 545e
   0976                                                                                          AT 545e
   0977   c  MARCH ALONG THE SURFACE TO FIND SOIL-ATMOSPHERE BOUNDARY NODES                      AT 545e
   0978   c  AND THEIR LATERAL COORDINATES                                                       AT 545e
   0979   c                                                                                      AT 545e
   0980         Do 95 i=1,ic                                                                     AT 545e
   0981           PSh=FSh(i,xBSTEM,SHADE,xS,ic)                                                  AT 5490
   0982           n=kS(i)                                                                        AT 54d2
   0983           k=codeT(n)                                                                     AT 54f9
   0984           Varbt(kS(i),4)=0.0                                                             AT 551b
   0985           VarBT(kS(i),3)=0.0                                                             AT 5545
   0986           VarBT(kS(i),2)=0.0                                                             AT 556f
   0987                                                                                          AT 5591
   0988           If (k.eq.-4) then                                                              AT 5591
   0989   C     if node is exposed                                                               AT 559e
   0990             If((PSh.gt.0).or.(NShoot.eq.0)) then                                         AT 559e
   0991   * If evaporation                                                                       AT 55dd
   0992   * calc heat flux due to latent heat of evaporation                                     AT 55dd
   0993   * given evaporation at it's potential rate                                             AT 55dd
   0994   * units are J day-1                                                                    AT 55dd
   0995   * RNS*3600*24/10000 is total energy going to soil in J day-1 cm-2                      AT 55dd
   0996   *  40.6 for mississippi                                                                AT 55dd
   0997   c           FELWR=max(0.0,(tmpr(i)-TairN)*FELWR)                                       AT 55dd
   0998   c           If (VarBW(i,2).ge.0.0.and.RNS.gt.0.0) then                                 AT 55dd
   0999                   VarBT(kS(i),4)=RNS*3600.0*24.0/10000.0                                 AT 55dd
   1000                                                                                          AT 5630
   1001   *  calculate convected heat  if soil is warmer than air                                AT 5630
   1002                                                                                          AT 5630
   1003   * FELWR should be zero when TAirN is warmer than soil                                  AT 5630
   1004                 if(tmpr(kS(i)).GT.TAirN) then                                            AT 5630
   1005                   VarBT(kS(i),2)=+FCSH+FELWR                                             AT 5667
   1006                   VarBT(kS(i),3)=VarBT(kS(i),2)*TAirN                                    AT 56a4
   1007                 endif                                                                    AT 56f0
   1008   C See if sensible heat transport works here in canopy                                  AT 56f0
   1009                 TFac=((0.058+1.7e-4*TAirN)+                                              AT 56f0
   1010        &            (0.052*EXP(.058*TAirN)))*0.004184*3600.0*24.0                        AT 56f0
   1011                  VarBT(kS(i),2)=VarBT(kS(i),2)+TFac                                      AT 5764
   1012                  VarBT(kS(i),3)=VarBT(kS(i),3)+TFac*TairN                                AT 579c
   1013                                                                                          AT 57cd
   1014            else                                                                          AT 57cd
   1015                                                                                          AT 57dc
   1016   *  the amount of heat added to the soil                                                AT 57dc
   1017   *     is determined by air temperature.                                                AT 57dc
   1018   *  units are millcal cm-2 sec-1 C-1                                                    AT 57dc
   1019                  VarBT(kS(i),2)=((0.058+1.7e-4*TAirN)+                                   AT 57dc
   1020        &                  (0.052*EXP(.058*TAirN)))                                       AT 57dc
   1021   * the first term is thermal conductivity of the air.                                   AT 586f
   1022   * the second term is the conductivity of water vapor                                   AT 586f
   1023   * Change units to Joules cm-2 d-1                                                      AT 586f
   1024                                                                                          AT 586f
   1025                  VarBT(kS(i),2)=VarBT(kS(i),2)*0.004184*3600.0*24.0                      AT 586f
   1026                  VarBT(kS(i),3)=VarBT(kS(i),2)*TairN                                     AT 58ab
   1027                                                                                          AT 5906
   1028   Cdt and a part for radiative transfer                                                  AT 5906
   1029                  if(tmpr(i).GT.TAirN) then                                               AT 5906
   1030                    VarBT(i,2)=VarBT(i,2)+(FCSH+FELWR)                                    AT 5935
   1031                    VarBT(i,3)=VarBT(i,3)+(FCSH+FELWR)*TAirN                              AT 5974
   1032                 endif                                                                    AT 59b5
   1033   c assume 5% of radiation reaches soil surface through canopy                           AT 59c4
   1034                 VarBT(kS(i),4)=amin1(0.0,1.0-BEERS)*RNS*3600.0*24.0/10000.0              AT 59c4
D:\2DSOIL_Grape\Soil Source\hourwea.for(1034) : warning 61 - Line has been truncated (line is longer than 72 characters) 
   1035                                                                                          AT 5a2d
   1036   *  units are now J cm-2 d-1                                                            AT 5a2d
   1037   * end if for crop canopy                                                               AT 5a2d
   1038             endif                                                                        AT 5a2d
   1039                                                                                          AT 5a35
   1040              VarBT(ks(i),1)=TAirN                                                        AT 5a35
   1041           Endif                                                                          AT 5a58
   1042   95    Continue                                                                         AT 5a58
   1043   C ...............End of heat balance                                                   AT 5a8a
   1044   c................... Gas movement                                                      AT 5a8a
   1045         Do i=1,NumBP                                                                     AT 5a8a
   1046         n=KXB(i)                                                                         AT 5aaf
   1047         k=CodeW(n)                                                                       AT 5ad5
   1048         If(K.eq.4.or.K.eq.-4) then                                                       AT 5aef
   1049           do jjj=1,NumG                                                                  AT 5b23
   1050             VarBG(i,jjj,2)=PG*Width(i)                                                   AT 5b4f
   1051             VarBG(i,jjj,3)=PG*GAIR(jjj)*Width(i)                                         AT 5bb0
   1052           Enddo                                                                          AT 5c2b
   1053         Endif                                                                            AT 5c48
   1054         Enddo                                                                            AT 5c48
   1055   c................... End gas movement                                                  AT 5c92
   1056   c................... Furrow irrigation                                                 AT 5c92
   1057   c                                                                                      AT 5c92
   1058         If(IfUR.eq.1) then                                                               AT 5c92
   1059           Do i=1,NumFP                                                                   AT 5c92
   1060           k=NumF(i)                                                                      AT 5cbf
   1061           QF=QF-Q(k)*Step                                                                AT 5ced
   1062           Enddo                                                                          AT 5d3a
   1063           If(QF.lt.0.0) then                                                             AT 5da9
   1064             QF=0.                                                                        AT 5da9
   1065             IfUR=0                                                                       AT 5da9
   1066             Do i=1,NumFP                                                                 AT 5da9
   1067              k=NumF(i)                                                                   AT 5ddf
   1068              CodeW(k)=-4                                                                 AT 5e0d
   1069             Enddo                                                                        AT 5e23
   1070           Endif                                                                          AT 5e82
   1071         Endif                                                                            AT 5e82
   1072   c................... End of the furrow irrigation                                      AT 5e82
   1073                                                                                          AT 5e82
   1074   c................... This is the end of hourly calculations                            AT 5e82
   1075                                                                                          AT 5e82
   1076         tNext(ModNum)=Time+period                                                        AT 5e82
   1077         Endif      ! hourly loop                                                         AT 5e82
   1078   c                                                                                      AT 5e82
   1079                                                                                          AT 5e82
   1080                                                                                          AT 5e82
   1081                                                                                          AT 5e82
   1082                                                                                          AT 5e82
   1083         RETURN                                                                           AT 5e82
   1084   10    call errmes(im,il)                                                               AT 5e87
   1085         END                                                                              AT 5f27
   1086   C                                                                                      AT 0
   1087                                                                                          AT 5f27
D:\2DSOIL_Grape\Soil Source\hourwea.for(1085) : warning 684 - There are (at least) 1 truncated line(s) in this file 




End of Compilation - Clocked 0.03 seconds
